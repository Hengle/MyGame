# 系统简介

服务器基于skynet框架，github : https://github.com/cloudwu/skynet.git
当将服务器工程 git clone 到本地时，需要在src/server/skynet目录中将skynet clone到本地，编译。

## access 接入服务器

1. 单节点，客户端保存该节点的访问地址，直接连接该节点
2. 客户端连接后，选择一个人数最少的登陆节点 login 返回给客户端（负载均衡），立马断掉连接。
3. 客户端保存 url ，通过 hettps 进行访问

## login 登陆服

1. 多节点，可动态扩容缩容
2. 玩家接入本节点后，进行登陆握手操作（密钥，token等）
3. 成功后，选择一个人数最少的网关节点 gate 返回给客户端（负载均衡），并转告该gate说客户端要登陆。然后断开连接。

## gate 网关服

1. 多节点，可动态扩容缩容
2. 客户端通过登陆验证后，直连网关，所有消息只跟网关交互。服务器内部对于客户端来说是一个黑盒。
3. gate 对客户端消息进行路由，发送到对应的服务上进行处理。处理完成后，服务反馈给对应的网关，网关将消息发送给客户端。

## plaza 大厅服

1. 多节点，可动态扩容缩容
2. 处理大厅中的业务
3. 大厅服就是大厅中一系列服务的合集（这些服务都可以单独拎出来，也可以合并到一个节点上）

## match 匹配服/撮合服

1. 多节点，可动态扩容缩容。一般情况下单节点。只有在用户量很大的时候才谨慎的拓展节点。
2. PVP玩法，撮合玩家，成功后选一个人数最少的游戏服game，让撮合好的一组玩家进去玩游戏。

## game 游戏服

1. 多节点，可动态扩容缩容
2. 游戏场景、游戏核心玩法、游戏逻辑

## db 数据库

1. 数据库用 MonogoDB 或者 MySQL + Redis 组合
2. 服务器是常驻内存，数据库是内容备份。

