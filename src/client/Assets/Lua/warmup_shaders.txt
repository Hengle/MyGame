local typeof = typeof
local GameObject = CS.UnityEngine.GameObject
local IOSystem = CS.War.Script.IOSystem

local ShaderCollectionWarmUp = CS.War.Render.ShaderCollectionWarmUp

module("warmup_shaders")

function WarmUp(callback)
	local prefabPath = "art/shadervariants/shadercollectionwarmup.prefab"
	IOSystem.LoadAssetAsync(prefabPath, nil, function (prefab)
		local go = GameObject.Instantiate(prefab)
		GameObject.DontDestroyOnLoad(go)
		
		local shaderCollectionWarmUp = go:GetComponent(typeof(ShaderCollectionWarmUp))
		shaderCollectionWarmUp:Warmup(function ()
			--GameObject.Destroy(go)
			--IOSystem.UnloadAssetBundle(prefabPath)
			
			if callback then
				callback()
			end
		end)
	end)
end